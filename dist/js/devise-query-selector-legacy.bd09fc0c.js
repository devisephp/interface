(self["webpackChunkdevisephp_interface"]=self["webpackChunkdevisephp_interface"]||[]).push([[969],{2696:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("fieldset",{staticClass:"dvs-fieldset"},[s("label",[e._v(e._s(e.value.label))]),s("date-picker",{ref:"datepicker",attrs:{settings:{date:!0,time:!0}},on:{change:e.updateValue}})],1)])},n=[],a=(s(1539),s(8783),s(3948),{name:"DeviseQuerySelectorText",components:{DatePicker:function(){return Promise.all([s.e(477),s.e(469)]).then(s.bind(s,6994))}},props:{value:{type:Object,required:!0}},methods:{updateValue:function(e){var t=this.value;t.value=e,this.$emit("input",t)}}}),i=a,l=s(1001),u=(0,l.Z)(i,r,n,!1,null,null,null),o=u.exports},4980:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dvs-text-gray-200"},[s("fieldset",{staticClass:"dvs-fieldset"},[s("label",{attrs:{for:"querykey"}},[e._v("Data Set Query")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"w-full",attrs:{id:"querykey",name:"querykey"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.query=t.target.multiple?s:s[0]}}},[s("option",{attrs:{disabled:""},domProps:{value:null}},[e._v("Please Select a Data Set Query")]),e._l(e.modelQueries,(function(t){return s("option",{key:t.key,domProps:{value:t.key}},[e._v(" "+e._s(t.description)+" ")])}))],2)]),e.selectedModelQuery&&e.selectedModelQuery.params.length>0?s("div",{staticClass:"dvs-mt-6"},e._l(e.selectedModelQuery.params,(function(t,r){return s("div",{key:r},["search"===t.type?s("param-search",{attrs:{"model-query":e.selectedModelQuery,"model-query-settings":t},model:{value:e.finalModelQuery.params[r],callback:function(t){e.$set(e.finalModelQuery.params,r,t)},expression:"finalModelQuery.params[key]"}}):e._e(),"text"===t.type?s("param-text",{staticClass:"dvs-mb-4",attrs:{"model-query":e.selectedModelQuery,"model-query-settings":t},model:{value:e.finalModelQuery.params[r],callback:function(t){e.$set(e.finalModelQuery.params,r,t)},expression:"finalModelQuery.params[key]"}}):e._e(),"select"===t.type?s("param-select",{staticClass:"dvs-mb-4",attrs:{"model-query":e.selectedModelQuery,"model-query-settings":t},model:{value:e.finalModelQuery.params[r],callback:function(t){e.$set(e.finalModelQuery.params,r,t)},expression:"finalModelQuery.params[key]"}}):e._e(),"datetime"===t.type?s("param-datetime",{staticClass:"dvs-mb-4",attrs:{"model-query":e.selectedModelQuery,"model-query-settings":t},model:{value:e.finalModelQuery.params[r],callback:function(t){e.$set(e.finalModelQuery.params,r,t)},expression:"finalModelQuery.params[key]"}}):e._e()],1)})),0):e._e()])},n=[],a=s(4367),i=(s(1539),s(8783),s(3948),s(9826),s(4747),s(8862),s(629)),l={name:"QuerySelector",components:{ParamDatetime:function(){return s.e(969).then(s.bind(s,2696))},ParamSearch:function(){return s.e(969).then(s.bind(s,7321))},ParamSelect:function(){return s.e(969).then(s.bind(s,9618))},ParamText:function(){return s.e(969).then(s.bind(s,6070))}},props:{value:{type:Object,required:!0}},data:function(){return{query:""}},computed:(0,a.Z)((0,a.Z)({},(0,i.rn)("devise",["modelQueries"])),{},{finalModelQuery:{get:function(){return this.value},set:function(e){this.$emit("input",e)},deep:!0},selectedModelQuery:function(){var e=this;return this.modelQueries.find((function(t){return t.key===e.query}))}}),watch:{selectedModelQuery:{handler:function(e){var t=this;this.finalModelQuery.params=[],e.params.forEach((function(e){"search"===e.type?t.finalModelQuery.params.push([]):t.finalModelQuery.params.push("")})),this.finalModelQuery.key=e.key},deep:!0}},mounted:function(){this.value&&this.value.key&&this.loadPreviousState()},methods:{loadPreviousState:function(){var e=this,t=JSON.parse(JSON.stringify(this.value.params));this.$set(this,"query",this.value.key),this.delay(1e3).then((function(){e.finalModelQuery.params=t}))},loadPreviousParams:function(e){var t=this;e.forEach((function(e,s){t.finalModelQuery.params[s]=e}))},delay:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}},u=l,o=s(1001),d=(0,o.Z)(u,r,n,!1,null,null,null),c=d.exports},7321:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"dvs-flex dvs-justify-center dvs-p-4 dvs-pb-8 dvs-text-gray-200 dvs-w-full"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],ref:"filter",staticClass:"dvs-bg-transparent dvs-border-b-2 dvs-px-12 dvs-py-2 dvs-text-gray-200 dvs-outline-none dvs-placeholder-admin-fg dvs-text-center",attrs:{type:"text",placeholder:e.value.label},domProps:{value:e.filter},on:{keyup:e.requestSearch,input:function(t){t.target.composing||(e.filter=t.target.value)}}}),s("div",{staticClass:"dvs-cursor-pointer",class:{"dvs-opacity-50":""===e.filter},on:{click:e.resetSearch}},[s("x-icon")],1)]),s("ul",e._l(e.filteredSuggestions,(function(t,r){return s("li",{key:r,staticClass:"dvs-bg-gray-800 dvs-shadow hover:dvs-shadow-lg dvs-rounded dvs-my-4 dvs-p-2 dvs-cursor-pointer",on:{click:function(s){return e.selectSuggestion(t)}}},[s("div",{staticClass:"dvs-text-lg dvs-mb-2"},[e._v(e._s(t.displayFields[0].value))]),s("ul",{staticClass:"dvs-flex"},e._l(e.subLabelFields(t.displayFields),(function(t,r){return s("li",{key:r,staticClass:"dvs-mr-4 dvs-text-xs dvs-leading-tight"},[s("div",{staticClass:"dvs-uppercase dvs-text-xs dvs-text-admin-secondary-fg"},[e._v(" "+e._s(t.label)+" ")]),s("div",[e._v(e._s(e.format(t)))])])})),0)])})),0),s("draggable",e._b({attrs:{list:e.selected,tag:"ul"}},"draggable",{group:{name:"g1"},animation:200,ghostClass:"dvs-ghost",handle:".handle",dragClass:"dvs-chosen-drag-slice",emptyInsertThreshold:10,removeCloneOnHide:!1},!1),e._l(e.selected,(function(t,r){return s("li",{key:r,staticClass:"dvs-flex dvs-bg-admin-secondary-bg dvs-text-admin-secondary-fg dvs-shadow hover:dvs-shadow-lg dvs-rounded dvs-my-4 dvs-p-4 dvs-cursor-pointer"},[e.modelQuerySettings.allowSort?s("div",{staticClass:"dvs-mr-4 handle"},[s("menu-icon")],1):e._e(),t.displayFields?s("div",{staticClass:"dvs-w-full"},[s("div",{staticClass:"dvs-text-lg dvs-mb-2"},[e._v(e._s(t.displayFields[0].value))]),s("ul",{staticClass:"dvs-flex"},e._l(e.subLabelFields(t.displayFields),(function(t,r){return s("li",{key:r,staticClass:"dvs-mr-4 dvs-text-xs dvs-leading-tight dvs-w-1/4 dvs-bg-gray-800 dvs-text-gray-200 dvs-rounded dvs-p-3 opacity-75"},[s("div",{staticClass:"dvs-uppercase dvs-text-xs"},[e._v(e._s(t.label))]),s("div",[e._v(e._s(e.format(t)))])])})),0)]):e._e(),s("div",{staticClass:"dvs-cursor-pointer",on:{click:function(s){return e.removeSuggestion(t)}}},[s("x-icon")],1)])})),0)],1)},n=[],a=s(3748);function i(e){if(Array.isArray(e))return(0,a.Z)(e)}s(2526),s(1817),s(1539),s(2165),s(8783),s(3948),s(1038);function l(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var u=s(8936);s(1703);function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return i(e)||l(e)||(0,u.Z)(e)||o()}var c=s(4367),v=(s(7327),s(9826),s(561),s(4747),s(8862),s(9600),s(7484)),f=s.n(v),p=s(629),m={name:"DeviseQuerySelectorSearch",components:{draggable:function(){return Promise.all([s.e(477),s.e(469)]).then(s.t.bind(s,9980,23))},XIcon:function(){return s.e(952).then(s.bind(s,7583))},MenuIcon:function(){return s.e(952).then(s.bind(s,1804))}},props:{value:{type:Array,required:!0},modelQuery:{type:Object,required:!0},modelQuerySettings:{type:Object,required:!0}},data:function(){return{filter:null,autosuggest:{data:[]}}},computed:{selected:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},filteredSuggestions:function(){var e=this;return this.autosuggest.data?this.autosuggest.data.filter((function(t){return!e.selected.find((function(e){return t===e}))})):[]}},watch:{value:function(e){e&&e.length>0&&"number"===typeof e[0]&&this.requestLegacySelected()}},mounted:function(){this.value&&this.value.length>0&&this.requestLegacySelected()},methods:(0,c.Z)((0,c.Z)({},(0,p.nv)("devise",["appGenericSearch","getGeneric"])),{},{selectSuggestion:function(e){this.selected.push(e),this.resetSearch()},removeSuggestion:function(e){this.resetSearch(),this.selected.splice(this.selected.indexOf(e),1)},resetSearch:function(){this.filter=null,this.$set(this.autosuggest,"data",[])},requestSearch:function(e){var t=this,s=e.target.value;if(""!==s){var r=[];this.selected.forEach((function(e){r.push(e.id)}));var n={searchterm:s,selected:r};this.appGenericSearch({config:{apiendpoint:this.modelQuery.params[0].api},filters:n}).then((function(e){t.autosuggest=e.data,e.data.length<1&&window.deviseSettings.$bus.$emit("showMessage",{title:"No Suggestions Found",message:"We couldn't find any data with the term: \"".concat(s,'".')})}))}else this.autosuggest=Object.assign({},{})},subLabelFields:function(e){var t=JSON.parse(JSON.stringify(e));return t.shift(),t},format:function(e){return e.dateFormat?f()(e.value).format(e.dateFormat):e.value},requestLegacySelected:function(){var e=this;this.modelQuery.params[0].editApi?this.getGeneric({config:{apiendpoint:this.modelQuery.params[0].editApi,app:!0},filters:{ids:this.value.join(",")}}).then((function(t){e.selected=d(t.data.data)})):console.warn("Devise: You must have an editApi endpoint configured AppServiceProvider ModelQuery::set to edit model slices")}})},y=m,h=s(1001),g=(0,h.Z)(y,r,n,!1,null,null,null),b=g.exports},9618:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("fieldset",{staticClass:"dvs-fieldset"},[s("label",[e._v("Please Select")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],staticClass:"dvs-w-full",attrs:{type:"text"},domProps:{value:e.value},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.localValue=t.target.multiple?s:s[0]}}},[s("option",{domProps:{value:null}},[e._v("Please Select from the Following")]),e._l(e.options,(function(t,r){return s("option",{key:r,domProps:{value:r}},[e._v(" "+e._s(t)+" ")])}))],2)])])},n=[],a=s(4367),i=s(629),l={name:"DeviseQuerySelectorSelect",props:{value:{type:String,required:!0},modelQuerySettings:{type:Object,required:!0}},data:function(){return{apiOptions:[]}},computed:{localValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},options:function(){return this.modelQuerySettings.options?this.modelQuerySettings.options:this.apiOptions}},mounted:function(){this.modelQuerySettings.api&&this.requestOptions()},methods:(0,a.Z)((0,a.Z)({},(0,i.nv)("devise",["getGeneric"])),{},{updateValue:function(e){var t=e.target.value;this.$emit("input",t)},requestOptions:function(){var e=this;this.getGeneric({config:{app:!0,apiendpoint:this.modelQuerySettings.api}}).then((function(t){e.apiOptions=t.data}))}})},u=l,o=s(1001),d=(0,o.Z)(u,r,n,!1,null,null,null),c=d.exports},6070:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("fieldset",{staticClass:"dvs-fieldset"},[s("label",[e._v(e._s(e.modelQuerySettings.label))]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],staticClass:"dvs-w-full",attrs:{type:"text",placeholder:e.modelQuerySettings.label},domProps:{value:e.localValue},on:{input:function(t){t.target.composing||(e.localValue=t.target.value)}}})])])},n=[],a={name:"DeviseQuerySelectorText",props:{value:{type:String,required:!0},modelQuerySettings:{type:Object,required:!0}},computed:{localValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},i=a,l=s(1001),u=(0,l.Z)(i,r,n,!1,null,null,null),o=u.exports},8457:function(e,t,s){"use strict";var r=s(7854),n=s(9974),a=s(6916),i=s(7908),l=s(3411),u=s(7659),o=s(4411),d=s(6244),c=s(6135),v=s(8554),f=s(1246),p=r.Array;e.exports=function(e){var t=i(e),s=o(this),r=arguments.length,m=r>1?arguments[1]:void 0,y=void 0!==m;y&&(m=n(m,r>2?arguments[2]:void 0));var h,g,b,S,_,Q,x=f(t),k=0;if(!x||this==p&&u(x))for(h=d(t),g=s?new this(h):p(h);h>k;k++)Q=y?m(t[k],k):t[k],c(g,k,Q);else for(S=v(t,x),_=S.next,g=s?new this:[];!(b=a(_,S)).done;k++)Q=y?l(S,m,[b.value,k],!0):b.value,c(g,k,Q);return g.length=k,g}},3411:function(e,t,s){var r=s(9670),n=s(9212);e.exports=function(e,t,s,a){try{return a?t(r(s)[0],s[1]):t(s)}catch(i){n(e,"throw",i)}}},1038:function(e,t,s){var r=s(2109),n=s(8457),a=s(7072),i=!a((function(e){Array.from(e)}));r({target:"Array",stat:!0,forced:i},{from:n})},3748:function(e,t,s){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}s.d(t,{Z:function(){return r}})},8936:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});s(7042),s(1539),s(8309),s(1038),s(8783),s(4916),s(7601);var r=s(3748);function n(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?(0,r.Z)(e,t):void 0}}}}]);
//# sourceMappingURL=devise-query-selector-legacy.bd09fc0c.js.map